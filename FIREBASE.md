# Firebase 運用の現実性

このプロジェクトでは **Firebase Hosting** と **Firestore** を使用しています。現状の使い方であれば、**今後も現実的に運用可能**です。

---

## 現在の利用内容

| サービス | 用途 | 負荷の目安 |
|----------|------|------------|
| **Firebase Hosting** | 静的サイトの配信（HTML/CSS/JS、data/ 以下すべて） | 静的のみ・サーバー不要 |
| **Firestore** | `student_logs` コレクション（生徒の反応・メモを教員画面で参照） | 閲覧時の書き込み＋管理画面での読み取り |

- コンテンツ（解説HTML・JSON）はすべて**静的ファイル**で、Firestore には保存していません。
- Firestore は「誰がどの問題のどのカードに反応・メモしたか」のログのみ。1ドキュメントあたり数百バイト程度です。

---

## 無料枠（Spark プラン）の目安

### Hosting
- **ストレージ**: 10 GB
- **転送量**: 360 MB/日

→ 解説ページ・JSON・画像が増えても、数十MB〜数百MB程度なら余裕。転送も個人〜小規模授業レベルならまず超えません。

### Firestore
- **読み取り**: 50,000 回/日
- **書き込み**: 20,000 回/日
- **ストレージ**: 1 GB

→ 生徒が「いいね」「メモ」するたびに 1 書き込み。1日 500 人が各 10 問×2 回操作しても 10,000 書き込みで、無料枠内です。教員が管理画面で一覧を見る読み取りも、問題数が数百程度なら無料枠で足ります。

---

## いつ有料になりうるか

- **Hosting**: 1日あたりの転送が 360MB を超えると Blaze（従量課金）が必要。アクセスがかなり増えないと到達しません。
- **Firestore**: 上記の読み取り・書き込みを超えると Blaze で従量課金（例: 書き込み約 $0.18/10万回）。大規模な授業や公開サービスで数千人/日レベルになる前に、[Firebase 料金](https://firebase.google.com/pricing) で概算するのがおすすめです。

現状の「静的サイト＋小規模ログ」であれば、**個人〜学校単位の利用なら数年単位で無料のまま運用できる可能性が高い**です。

---

## 運用上の推奨

1. **Firebase コンソールで使用量をたまに確認する**  
   [Firebase Console](https://console.firebase.google.com/) → プロジェクト → 使用量と請求。Hosting の転送と Firestore の読み書きが増えていないか見ておくと安心です。

2. **Firestore のセキュリティルールを設定する**  
   現状、リポジトリに `firestore.rules` が含まれていません。コンソールで「誰でも読み書き可」のままにしている場合は、本番では以下を検討してください。
   - `student_logs`: 書き込みは認証済みユーザーまたは匿名可、読み取りは管理用（Admin SDK や認証済み教員のみ）に制限する。
   - ルール例は [Firestore セキュリティルール](https://firebase.google.com/docs/firestore/security/get-started) を参照。

3. **API キーなどの扱い**  
   `config/firebase-config.js` はクライアントに露出するため、Firebase の「アプリの制限」（HTTP リファラー等）を設定しておくとよいです。秘密鍵（サービスアカウント）はクライアントに含めないでください（現状も含まれていません）。

---

## 結論

- **現状の使い方（Hosting ＋ 少容量の Firestore ログ）のまま、今後も Firebase で運用するのは現実的**です。
- 無料枠で収まる範囲が広く、有料になっても従量課金で小規模なら月数百円〜千円程度のイメージです。
- コンテンツはすべて静的なので、将来的に「Hosting だけ別 CDN に移す」「ログだけ別 BaaS に移す」といった部分的な移行も可能ですが、**今の規模なら Firebase のまま続けて問題ありません**。
