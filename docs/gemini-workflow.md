# 解説ページ作成ワークフロー（Cursor 単体）

問題画像を Cursor に添付し、**外部AI（Gemini 等）は使わず**、解説を0から生成する方式です。

---

## 基本方針

- **解説は Cursor 単体で作成する**。添付された問題画像を読み取り、解法の指針・各設問の解説・答え・Point・図・シミュを一貫して生成する。
- **入試問題のように長い問題**は、**小分けして依頼し、増築**することで質を上げる（一気に全設問を書かず、段階的に追加する）。

---

## 推奨の進め方

### 短い問題（小問が少ない場合）

1. 問題画像を添付し、「この問題の解説ページを作って」と依頼する。
2. Cursor が画像を読み取り、解法の指針＋全設問の解説を1本の HTML で出力する。
3. 保存先の決定・CSS 相対パス・`data/materials/exam_national.json` の更新も Cursor が行う（`.cursor/rules/cursor-explanation-from-images.mdc` に従う）。

### 長い問題（入試大問など・設問が多い場合）

1. **1回目**：「この問題の解説の土台を作って。タイトル・解法の指針・問(1)の(a)(b)まででよい」のように依頼する。
   - 冒頭の「解法の指針」では、問題の構成を**問(1)(2)... 単位**でまとめておき、まだ未執筆の小問も一行要約で触れておく。
   - この時点でファイルの新規作成・マニフェスト登録まで行う。

2. **2回目以降**：「問(1)(c)(d)を追加して」「問(2)の(a)(b)を追加して」のように、**既存の HTML に追記**する。
   - 既存の `.card` の並びを崩さず、適切な位置に新しい `.card` を挿入する。
   - 必要に応じて「解法の指針」内の「問題の構成」の該当行を微修正してよい。

3. 全設問が揃うまで、同じファイルに対して増築を繰り返す。

---

## ルール・参照ファイル

| 内容 | 参照先 |
|------|--------|
| 解説ページのHTML構造・Point配置・図の置き方 | `.cursor/rules/explanation-pages.mdc` |
| 問題画像からの生成・増築の手順・トリガー例 | `.cursor/rules/cursor-explanation-from-images.mdc` |
| 既存の解説例（構造・図・シミュの参考） | `data/explanations/exam_national/tohoku/2008/2008_zenki_2.html` など |

---

## 保存先・マニフェスト

- **保存パス**：`data/explanations/exam_national/{folderName}/{year}/{year}_zenki_{大問}.html`（後期の場合は `kou`）。
- **CSS 相対パス**：上記はプロジェクトルートから5階層下なので `../../../../../css/`。
- **マニフェスト**：`data/materials/exam_national.json` の該当 subject の該当年度 `problems` に `id`, `title`, `desc`, `explanationPath` を追加。新規作成時のみ追加し、増築時は既存エントリのままファイルを更新する。

---

## 参考：以前の Gemini 連携（非推奨・アーカイブ）

以前は問題画像を Gemini に送り、出力を Cursor に貼り付けて解説を量産するワークフローも用意していた。**質を優先するため現在は Cursor 単体方式に統一**している。  
旧プロンプト・ひな型は **docs/gemini/** に残してある（参考用）。新規の解説作成では使用しない。
