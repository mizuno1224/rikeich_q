# Cursorでの解説ページ自動生成ワークフロー

このドキュメントは、Cursorのチャット機能を使って画像やPDFから自動的に解説ページを生成する手順を説明します。

## 基本的な使い方

### 1. 画像・PDFのアップロード

Cursorのチャットに画像やPDFをドラッグ&ドロップまたはアップロードボタンから追加します。

### 2. 教材情報の指定

アップロード後、以下の情報をチャットで指定してください：

```
以下の問題について解説ページを作成してください。

【教材情報】
- 教材タイプ: 共通テスト (exam_common)
- 年度: 2026
- 問題番号: 大問1
- 単元名: 力学
- ファイル名ID: 2026_q1
```

### 3. 自動生成の実行

Cursorが自動的に以下を実行します：
1. 画像/PDFから問題内容を読み取り
2. 解説HTMLを生成
3. 登録用JSONを生成
4. 適切な場所にファイルを保存
5. マニフェストを更新

### 4. 確認と調整

生成されたファイルを確認し、必要に応じて調整してください。

## 教材タイプ一覧

| 教材タイプ | ID | 説明 |
| :--- | :--- | :--- |
| 物理基礎 | `textbook_basic` | 物理基礎の教科書 |
| 物理 | `textbook_physics` | 物理の教科書 |
| リードα | `lead_alpha` | リードα問題集 |
| リードLight | `lead_light` | リードLight問題集 |
| 共通テスト | `exam_common` | 大学入学共通テスト |
| 国公立入試 | `exam_national` | 国公立大学入試 |
| 私立入試 | `exam_private` | 私立大学入試 |
| その他 | `other` | その他の教材 |

## 入力フォーマット例

### 教科書の場合

```
以下の問題について解説ページを作成してください。

【教材情報】
- 教材タイプ: 物理基礎 (textbook_basic)
- 編ID: 01
- 章ID: 01
- 問題番号: p.24 例1
- 単元名: 運動の表し方
- ファイル名ID: p24_ex1
```

### 入試問題の場合

```
以下の問題について解説ページを作成してください。

【教材情報】
- 教材タイプ: 共通テスト (exam_common)
- 年度: 2026
- 問題番号: 第1問
- ファイル名ID: 2026_q1
```

### リード系の場合

```
以下の問題について解説ページを作成してください。

【教材情報】
- 教材タイプ: リードα (lead_alpha)
- 章ID: 01
- 問題番号: 問3
- ファイル名ID: ch01_q3
```

## 生成されるファイル

### 1. 解説HTMLファイル

`data/explanations/{教材ID}/{パス}/{ID}.html` に保存されます。

例：
- `data/explanations/textbook_basic/01/01/p24_ex1.html`
- `data/explanations/exam_common/2026/2026_q1.html`

### 2. マニフェストの更新

`data/materials/{教材ID}.json` が自動的に更新され、新しい問題が登録されます。

## 確認方法

### 1. ローカルでの確認

```bash
firebase emulators:start
```

ブラウザで `http://localhost:5000/admin.html` にアクセスし、生成された問題を確認できます。

### 2. ファイルの直接確認

生成されたHTMLファイルを直接開いて内容を確認できます。

## トラブルシューティング

### 問題が見つからない場合

画像/PDFから問題を特定できない場合、Cursorが問題文の入力を求めます。その場合は、問題文をテキストで入力してください。

### ID重複エラー

既に同じIDの問題が存在する場合、上書きするか新しいIDを指定するか確認されます。

### パスエラー

指定したパスが無効な場合、正しいパス形式を確認してください。`.cursorrules` の「ファイル命名とパス規則」セクションを参照してください。

## 高度な使い方

### 複数問題の一括生成

複数の画像を一度にアップロードし、それぞれについて解説ページを生成することができます。

### 既存問題の更新

既存の問題IDを指定すると、既存の解説ページを更新できます。

### カスタム指示

特定のシミュレーションや解説方法を指定したい場合は、チャットで詳細な指示を追加してください。

例：
```
上記の問題について、特にドップラー効果の可視化シミュレーションを追加してください。
```

## ベストプラクティス

1. **明確な教材情報の指定**: 教材タイプ、年度、問題番号などを明確に指定することで、正確なパスが生成されます。

2. **適切なIDの命名**: ファイル名IDは半角英数で、他の問題と重複しないように命名してください。

3. **生成後の確認**: 自動生成された内容を必ず確認し、必要に応じて調整してください。

4. **Git管理**: 生成後は適切にコミット・プッシュして、変更履歴を管理してください。

## 関連ファイル

- `.cursorrules`: Cursorの自動処理ルール
- `プロンプト.txt`: 詳細な生成ルール（Gemini用の元プロンプト）
- `チャット.txt`: ユーザー入力フォーマットの参考
- `sample.html`: HTML構造のテンプレート
- `memo.txt`: プロジェクト管理マニュアル
